<div data-ng-controller="ServiceSuppliersDetailController">
    <div class="row">
        <div class="col-md-3">

            <p class="lead">Prestador de Servicios</p>
            <div class="list-group">
                <a ui-sref=".detail({ servicesupplierId: servicesupplier._id })" ui-sref-opts="{reload: true}" class="list-group-item">Detalles</a>
                <a ui-sref=".jobs({ servicesupplierId: servicesupplier._id, currentPage: 1})" ui-sref-opts="{reload: true}" class="list-group-item">Trabajos</a>
                <a ui-sref=".reviews({ servicesupplierId: servicesupplier._id, currentPage: 1})" ui-sref-opts="{reload: true}" class="list-group-item">Calificaciones</a>
            </div>

        </div>
        <div class="col-md-9">
            <section data-ui-view></section>
        </div>
    </div>
</div>

<script type="text/ng-template" id="jobTypeaheadTemplate.html">
    <a>
        <span data-ng-bind-html="match.label | uibTypeaheadHighlight:query"></span>
        <span>, {{match.model.start_date | date: 'shortDate'}} - {{match.model.finish_date | date: 'shortDate'}}</span>
    </a>
</script>

<script type="text/ng-template" id="addSupplierReviewModal">
    <div class="modal-header">
        <h3 class="modal-title">Calificacion del prestador de servicios</h3>
    </div>
    <div class="modal-body">

        <uib-alert type="{{alerts.type}}" close="alerts.close()" data-ng-show="alerts.visible">{{alerts.msg}}</uib-alert>

        <div data-ng-show="jobsforreview.length && jobsforreviewvisible">
            <h4 class="review-services-title">Calificar un trabajo existente</h4>
            <div class="btn-group" uib-dropdown>
                <button type="button" class="btn btn-default" uib-dropdown-toggle>
                    {{selectedjob.name}} <span class="caret"></span>
                </button>
                <ul class="uib-dropdown-menu" role="menu">
                    <li data-ng-repeat="jobforreview in jobsforreview">
                        <a class="dropdown-item" data-ng-click="setJobProperties(jobforreview)">{{jobforreview.name}}</a>
                    </li>
                </ul>
            </div>
            <button class="btn btn-danger" type="button" data-ng-show="selectedjob._id" data-ng-click="removeJobSelection()">
                <span class="glyphicon glyphicon-remove"></span> Cancelar seleccion
            </button>
        </div>
        <br>
        <div data-ng-show="reviewservicesvisible">
            <h4 class="review-services-title">Servicios</h4>
            <input type="text" data-ng-model="selectedservice" class="form-control review-service-selector" typeahead-on-select="selectService($item)"
                   uib-typeahead="servicesubcategory.name for servicesubcategory in servicesubcategories | filter:{name: $viewValue} | limitTo:8"
                   placeholder="Selecciona un servicio." data-ng-show="!selectedjob._id">

            <div data-ng-show="selectedservices.length" class="review-selected-services">
                <button data-ng-click="deleteSelectedService($index)" type="button" class="btn btn-default review-selected-service"
                        data-ng-repeat="selectedservice in selectedservices" data-ng-disabled="selectedjob._id">
                    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> {{selectedservice.name}}</button>
            </div>
        </div>


        <div class="row">
            <div class="col-md-6 col-sm-6 col-xs-6">
                <h4 class="review-ratings-title">Resultado del trabajo</h4>
                    <div class="btn-group" uib-dropdown>
                        <button type="button" class="btn btn-default" uib-dropdown-toggle data-ng-disabled="statusdisabled">
                            {{jobstatus.name}} <span class="caret"></span>
                        </button>
                        <ul class="uib-dropdown-menu" role="menu">
                            <li data-ng-repeat="status in jobstatuses">
                                <a class="dropdown-item" data-ng-click="changeStatus(status)">{{status.name}}</a>
                            </li>
                        </ul>
                    </div>
            </div>
            <div class="col-md-6 col-sm-6 col-xs-6 pull-right" data-ng-show="statusreasonsvisible">
                <h4 class="review-ratings-title">Razon del resultado</h4>
                <div class="btn-group" uib-dropdown>
                    <button type="button" class="btn btn-default" uib-dropdown-toggle data-ng-disabled="statusreasonsdisabled">
                        {{statusreason.description}} <span class="caret"></span>
                    </button>
                    <ul class="uib-dropdown-menu" role="menu">
                        <li data-ng-repeat="statusreason in statusreasons">
                            <a class="dropdown-item" data-ng-click="changeStatusReason(statusreason)">{{statusreason.description}}</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 col-sm-6 col-xs-6" data-ng-show="jobfinishdatevisible">
                <h4 class="review-ratings-title">Fecha de finalizaci&#243;n</h4>
                <p class="input-group">
                    <input type="text" class="form-control" uib-datepicker-popup="{{dateFormat}}" data-ng-model="jobfinishdate"
                           min-date="selectedjob.start_date || today" max-date="today" show-button-bar="false" is-open="finishDatePicker.opened"
                           data-ng-required="true"/>
                    <span class="input-group-btn">
                                    <button id="finishDateButton" type="button" class="btn btn-default" data-ng-click="openDatePicker($event, finishDatePicker)">
                                        <i class="glyphicon glyphicon-calendar"></i>
                                    </button>
                                  </span>
                </p>
            </div>
        </div>


        <h4 class="review-ratings-title">Ratings</h4>
        <div class="review-ratings-container">
            <div data-ng-repeat="rating in ratings">
                {{rating.name}} <a uib-tooltip="{{rating.description}}"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span></a>
                <div class="pull-right">
                    <uib-rating data-ng-model="rating.rate" max="5" class="review-rating-selector"></uib-rating>{{rating.rate}} Estrellas
                </div>
            </div>
        </div>


        <div class="review-ratings-container">
            <h5>Recomendar&#237a este proveedor a un amigo</h5>
            <input type="radio" data-ng-model="recommend" value="true">Si</input>
            <input type="radio" data-ng-model="recommend" value="false">No</input>
        </div>

        <textarea data-ng-model="comment" class="form-control comments-text-area" cols="30" rows="4" placeholder="Deja un comentario aqui."></textarea>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button" data-ng-click="ok()">OK</button>
        <button class="btn btn-default" type="button" data-ng-click="cancel()">Cancelar</button>
    </div>
</script>